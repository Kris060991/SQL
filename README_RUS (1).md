## _Deep diving into JOINs in SQL_

В этом проекте ты освоишь основные навыки работы с SQL и реляционными базами данных: понимание реляционной алгебры, использование различных типов соединений (JOIN), создание запросов с помощью CTE, обработку пропущенных значений, фильтрацию и сортировку данных.

Эти умения пригодятся в разработке, оптимизации баз данных, аналитике и программировании для эффективной работы с данными и принятия решений на их основе.

1. **Таблица pizzeria** (справочник пиццерий)
   - поле id - первичный ключ
   - поле name - название пиццерии
   - поле rating - средний рейтинг пиццерии (от 0 до 5 баллов)

2. **Таблица person** (справочник клиентов, любящих пиццу)
   - поле id - первичный ключ
   - поле name - имя человека
   - поле age - возраст человека
   - поле gender - пол человека
   - поле address - адрес человека

3. **Таблица menu** (справочник с доступным меню и ценами на конкретные пиццы)
   - поле id - первичный ключ
   - поле pizzeria_id - внешний ключ на таблицу pizzeria
   - поле pizza_name - название пиццы в пиццерии
   - поле price - цена конкретной пиццы

4. **Таблица person_visits** (журнал посещений пиццерий)
   - поле id - первичный ключ
   - поле person_id - внешний ключ на таблицу person
   - поле pizzeria_id - внешний ключ на таблицу pizzeria
   - поле visit_date - дата посещения (например, 2022-01-01)

5. **Таблица person_order** (журнал заказов)
   - поле id - первичный ключ
   - поле person_id - внешний ключ на таблицу person
   - поле menu_id - внешний ключ на таблицу menu
   - поле order_date - дата заказа (например, 2022-01-01)

Посещения пиццерий и заказы - это разные сущности, между которыми нет прямой зависимости в данных. Например, клиент может находиться в одном ресторане, просто просматривая меню, и одновременно сделать заказ в другом ресторане по телефону или через мобильное приложение. Или другой вариант - быть дома и оформить заказ по телефону, не посещая заведение вовсе.

## Задание 00 — Move to the LEFT, move to the RIGHT

| **Запрещено** | |
| Синтаксические конструкции SQL | `NOT IN`, `IN`, `NOT EXISTS`, `EXISTS`, `UNION`, `EXCEPT`, `INTERSECT` |

Напиши SQL-запрос, который выведет список пиццерий с их рейтингом, но только те, которые никто не посещал.

## Задание 01 — Find data gaps

| **Запрещено** | |
| Синтаксические конструкции SQL | `NOT IN`, `IN`, `NOT EXISTS`, `EXISTS`, `UNION`, `EXCEPT`, `INTERSECT` |

Напиши SQL-запрос, который возвращает отсутствующие даты с 1 по 10 января 2022 года (включительно) для посещений людьми с идентификаторами 1 и 2 — то есть дни, пропущенные обоими.

Отсортируй результат по дате посещения в порядке возрастания.

Изучи образец ожидаемого результата ниже.

| missing_date |
|--------------|
| 2022-01-03 |
| 2022-01-04 |
| 2022-01-05 |
| ... |

## Задание 02 — FULL means 'completely filled'

| **Запрещено** | |
| Синтаксические конструкции SQL | `NOT IN`, `IN`, `NOT EXISTS`, `EXISTS`, `UNION`, `EXCEPT`, `INTERSECT` |

Напишите SQL-запрос, который возвращает:

- Полный список имен людей, посетивших (или не посетивших) пиццерии в период с 1 по 3 января 2022 года
- Полный список названий пиццерий, которые посещались (или не посещались) в этот же период

Ниже приведен пример данных с указанием требуемых названий колонок.

Для NULL-значений в колонках person_name и pizzeria_name используй замену на '-'. Добавь сортировку по всем трем колонкам.

| person_name | visit_date | pizzeria_name |
|-------------|------------|---------------|
| - | null | DinoPizza |
| - | null | DoDo Pizza |
| Andrey | 2022-01-01 | Dominos |
| Andrey | 2022-01-02 | Pizza Hut |
| Anna | 2022-01-01 | Pizza Hut |
| Denis | null | - |
| Dmitriy | null | - |
| ... | ... | ... |

## Задание 03 — Reformat to CTE

| **Запрещено** | |
| Синтаксические конструкции SQL | `NOT IN`, `IN`, `NOT EXISTS`, `EXISTS`, `UNION`, `EXCEPT`, `INTERSECT` |

Вернись к Заданию 01 и перепиши SQL-запрос, используя CTE (Common Table Expression). В CTE-блоке реализуй генератор дат. Результат должен совпадать с результатом из Задания 01.

| missing_date |
|--------------|
| 2022-01-03 |
| 2022-01-04 |
| 2022-01-05 |
| ... |

## Задание 04 — Find favourite pizzas

Найди полную информацию обо всех возможных вариантах пиццерий и ценах на пиццу с грибами или пепперони.

Отсортируй результаты по названию пиццы и названию пиццерии.

Пример ожидаемого результата с названиями колонок приведен ниже (используй те же имена колонок в своем SQL-запросе).

| pizza_name | pizzeria_name | price |
|------------|---------------|-------|
| mushroom pizza | Dominos | 1100 |
| mushroom pizza | Papa Johns | 950 |
| pepperoni pizza | Best Pizza | 800 |
| ... | ... | ... |

## Задание 05 — Investigate Person Data

Найди имена всех женщин старше 25 лет и отсортируй результат по имени. Пример вывода приведен ниже.

| name |
|------|
| Elvira |
| ... |

## Задание 06 — Favourite pizzas for Denis and Anna

Найдите все названия пицц (и соответствующие названия пиццерий из таблицы menu), которые заказывали Денис или Анна.

Отсортируй результат по обеим колонкам.

Пример вывода данных представлен ниже.

| pizza_name | pizzeria_name |
|------------|---------------|
| cheese pizza | Best Pizza |
| cheese pizza | Pizza Hut |
| ... | ... |

## Задание 07 — Cheapest pizzeria for Dmitriy

Определи название пиццерии, которую Дмитрий посетил 8 января 2022 года, где он мог заказать пиццу дешевле 800 рублей.

## Задание 08 — Continuing to research data

Найди имена всех мужчин из Москвы или Самары, которые заказывали пиццу с пепперони, грибами или оба вида сразу.

Отсортируй результат по именам в обратном алфавитном порядке.

Пример ожидаемого результата приведен ниже.

| name |
|------|
| Dmitriy |
| ... |

## Задание 09 — Who loves cheese and pepperoni?

Найди имена всех женщин, которые заказывали и пепперони, и сырную пиццу (в любое время и в любых пиццериях).

Отсортируй результат по именам в алфавитном порядке.

Пример ожидаемого результата приведен ниже.

| name |
|------|
| Anna |
| ... |

## Задание 10 — Find persons from one city

Найди имена людей, проживающих по одному адресу (в одном городе).

Результат должен быть отсортирован в три колонки: по имени первого человека, имени второго человека и общему адресу.

Пример результата приведен ниже.

Используй в своем запросе указанные ниже названия колонок.

| person_name1 | person_name2 | common_address |
|--------------|--------------|----------------|
| Andrey | Anna | Moscow |
| Denis | Kate | Kazan |
| Elvira | Denis | Kazan |
| ... | ... | ... |