## Основы работы с множествами и объединениями (JOIN) в SQL

В этом проекте ты освоишь основные навыки работы с SQL: использование множеств и операторов объединения, создание подзапросов, сортировку по нескольким столбцам, а также разные виды соединений таблиц. Ты научишься находить пересечения и различия в данных, что важно для анализа и решения бизнес-задач.

1. **Таблица pizzeria** (справочник пиццерий)
   - поле id - первичный ключ
   - поле name - название пиццерии
   - поле rating - средний рейтинг пиццерии (от 0 до 5 баллов)

2. **Таблица person** (справочник клиентов, любящих пиццу)
   - поле id - первичный ключ
   - поле name - имя человека
   - поле age - возраст человека
   - поле gender - пол человека
   - поле address - адрес человека

3. **Таблица menu** (справочник с доступным меню и ценами на конкретные пиццы)
   - поле id - первичный ключ
   - поле pizzeria_id - внешний ключ на таблицу pizzeria
   - поле pizza_name - название пиццы в пиццерии
   - поле price - цена конкретной пиццы

4. **Таблица person_visits** (журнал посещений пиццерий)
   - поле id - первичный ключ
   - поле person_id - внешний ключ на таблицу person
   - поле pizzeria_id - внешний ключ на таблицу pizzeria
   - поле visit_date - дата посещения (например, 2022-01-01)

5. **Таблица person_order** (журнал заказов)
   - поле id - первичный ключ
   - поле person_id - внешний ключ на таблицу person
   - поле menu_id - внешний ключ на таблицу menu
   - поле order_date - дата заказа (например, 2022-01-01)

Посещения пиццерий и заказы - это разные сущности, между которыми нет прямой зависимости в данных. Например, клиент может находиться в одном ресторане, просто просматривая меню, и одновременно сделать заказ в другом ресторане по телефону или через мобильное приложение. Или другой вариант - быть дома и оформить заказ по телефону, не посещая заведение вовсе.

## Задание 00 — Let's make UNION dance

Напиши SQL-запрос, который объединит в один общий список идентификаторы меню и названия пицц из таблицы menu, а также идентификаторы и имена людей из таблицы person.

В итоговом результате столбцы должны называться так, как показано в примере ниже - сначала выборка по object_id, а затем по object_name.

| object_id | object_name |
|-----------|-------------|
| 1 | Anna |
| 1 | cheese pizza |
| ... | ... |

## Задание 01 — UNION dance with subquery

Измени SQL-запрос из "Задания 00" следующим образом:

- Удали столбец object_id
- Измени порядок сортировки: сначала выведи данные из таблицы person (по object_name), затем из таблицы menu (также по object_name) - как показано в примере ниже

Сохрани дублирующиеся строки.

| object_name |
|-------------|
| Andrey |
| Anna |
| ... |
| cheese pizza |
| cheese pizza |
| ... |

## Задание 02 — Duplicates or not duplicates
| **Запрещено** | |
| Синтаксические конструкции SQL | `DISTINCT`, `GROUP BY`, `HAVING`, все виды `JOINs` |

Напиши SQL-запрос, который:

- Возвращает уникальные названия пицц из таблицы menu
- Сортирует результаты по столбцу pizza_name в порядке убывания

## Задание 03 — "Hidden" Insights
| **Запрещено** | |
| Синтаксические конструкции SQL | все виды `JOINs` |

Напиши SQL-запрос, который:

Находит пересечение данных по:

- Дате заказа (order_date) и ID человека (person_id) из таблицы person_order
- Дате визита (visit_date) и ID человека (person_id) из таблицы person_visits

См. пример ниже. Проще говоря, тебе нужно найти идентификаторы людей, которые в один и тот же день и посетили заведение, и сделали заказ пиццы.

При этом результат следует отсортировать сначала по дате действия (action_date) в порядке возрастания, а затем по person_id — в порядке убывания.

| action_date | person_id |
|-------------|-----------|
| 2022-01-01 | 6 |
| 2022-01-01 | 2 |
| 2022-01-01 | 1 |
| 2022-01-03 | 7 |
| 2022-01-04 | 3 |
| ... | ... |

## Задание 04 — Difference? Yep, let's find the difference between multisets
| **Запрещено** | |
| Синтаксические конструкции SQL | все виды `JOINs` |

Напиши SQL-запрос, который вернет разницу (операция MINUS) по значениям столбца person_id между таблицами person_order и person_visits, при этом сохраняя дубликаты.

Запрос должен учитывать только записи за 7 января 2022 года

- Для таблицы person_order - где order_date = '2022-01-07'
- Для таблицы person_visits - где visit_date = '2022-01-07'

## Задание 05 — Did you hear about Cartesian Product?
Напиши SQL-запрос, который вернет все возможные комбинации записей из таблиц person и pizzeria.

В результате выполнения запроса сначала должны идти столбцы с идентификаторами из таблицы person, а затем — из таблицы pizzeria.

## Задание 06 — Lets see on "Hidden" Insights
Вернемся к Заданию 03 и изменим SQL-запрос так, чтобы он возвращал имена людей вместо их идентификаторов.

Измени сортировку:

- Сначала по дате действия (action_date) в порядке возрастания
- Затем по имени человека (person_name) в порядке убывания

Изучи образец ожидаемого результата ниже.

| action_date | person_name |
|-------------|-------------|
| 2022-01-01 | Irina |
| 2022-01-01 | Anna |
| 2022-01-01 | Andrey |
| ... | ... |

## Задание 07 — Just make a JOIN
Напиши SQL-запрос, который возвращает:

- Дату заказа из таблицы person_order
- Имя человека, сделавшего заказ (из таблицы person), имя и возраст должны быть отформатированы, как показано в образце ниже

Сортирует результаты по обоим столбцам в порядке возрастания.

| order_date | person_information |
|------------|-------------------|
| 2022-01-01 | Andrey (age:21) |
| 2022-01-01 | Andrey (age:21) |
| 2022-01-01 | Anna (age:16) |
| ... | ... |

## Задание 08 — Migrate JOIN to NATURAL JOIN

Перепиши SQL-запрос из Задания 07, используя конструкцию NATURAL JOIN. Результат должен совпадать с результатом из Задания 07.

## Задание 09 — IN versus EXISTS

Напиши два SQL-запроса, которые возвращают список пиццерий, в которые не заходили люди: первый — с использованием оператора IN, второй — с использованием EXISTS.

## Задание 10 — Global JOIN

Напиши SQL-запрос, который вернет список имен людей, заказавших пиццу в соответствующей пиццерии.

Возвращает список людей, заказавших пиццу, с указанием:

- Имени клиента
- Названия пиццы
- Названия пиццерии

Сортирует результаты по трем столбцам (все по возрастанию):

- person_name (имя клиента)
- pizza_name (название пиццы)
- pizzeria_name (название пиццерии)

Изучи образец ожидаемого результата ниже.

| person_name | pizza_name | pizzeria_name |
|-------------|------------|---------------|
| Andrey | cheese pizza | Dominos |
| Andrey | mushroom pizza | Dominos |
| Anna | cheese pizza | Pizza Hut |
| ... | ... | ... |